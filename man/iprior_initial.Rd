% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/zzz_internal_init.R
\name{iprior_initial}
\alias{iprior_initial}
\alias{pre_initial}
\title{Initial Hyperparameter Estimation for I-prior Models}
\usage{
pre_initial(
  X,
  Y,
  dat_T,
  kernels,
  kernels_params,
  center = FALSE,
  G = NULL,
  Index,
  kernel_iprior = "cfbm",
  iprior_param = NULL,
  constant = TRUE,
  os_type = "Apple",
  cores = NULL,
  sample_id = 1
)
}
\arguments{
\item{X}{Covariate matrix/array}

\item{Y}{Response vector}

\item{dat_T}{List of index values for each mode}

\item{kernels}{List of kernel functions. Refer to \code{\link{kernels_fire}} for available kernel functions}

\item{kernels_params}{List of parameters for each kernel}

\item{center}{Logical indicating whether to center the kernel matrices in \code{gmat}}

\item{G}{List of kernel matrices from \code{gmat}}

\item{Index}{Matrix of indices for tensor vectorization}

\item{kernel_iprior}{Kernel function for iprior model}

\item{iprior_param}{Parameter of kernel in iprior}

\item{constant}{Logical indicating whether to include constant kernel term}

\item{os_type}{Operating system for parallelization ("Apple" or "Windows")}

\item{cores}{Number of cores for parallel computation (default: detectCores() - 1)}

\item{sample_id}{Which mode represents samples, either the 1st or the last mode}
}
\value{
List containing two vectors of the initial values for EM algorithm:
\itemize{
  \item \code{lambda}: Asymptote for lambda (scale parameter)
  \item \code{sigma}: Asymptote for noise parameter
}
}
\description{
Internal function to estimate initial hyperparameters for I-prior EM algorithm.
  Computes asymptotically optimal starting values for lambda and sigma parameters.
  Used internally by \code{\link{fire}}. Not exported.
}
\examples{
# vector covariates
set.seed(1)
X <- matrix(runif(20, 5, 10), ncol = 4) # 5 samples
Y <- runif(5, 5, 10)
dat_T <- list(1:4)
Index <- expand.grid(1:5)

init_cfbm <- fire:::pre_initial(X, Y, dat_T,
                        kernels = list(cfbm),
                        kernels_params = list(0.5),
                        Index = Index, constant = FALSE,
                        kernel_iprior = "cfbm", cores = 1)

# 3D covariates
X <- list(array(runif(20, 5, 10), dim = c(2,2,5)),array(runif(20, 5, 10), dim = c(2,2,5)))
Y <- runif(2, 5, 10)
dat_T <- list(1:2, 1:2, 1:5)
Index <- expand.grid(T3 = 1:5, T2 = 1:2, T1 = 1:2)
Index <- cbind(Index$T1, Index$T2, Index$T3)

init_rbf <- fire:::pre_initial(X, Y, dat_T,
                       kernels = list(cfbm, rbf, cfbm),
                       kernels_params = list(0.5, 1, 0.5),
                       Index = Index, constant = TRUE,
                       kernel_iprior = "rbf", cores = 1)

}
\seealso{
\code{\link{fire.matrix}}, \code{\link{fire.tensor}}, \code{\link{kernels_fire}}
}
\keyword{internal}
